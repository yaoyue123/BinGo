# Binary Vulnerability Analysis Report

**Generated by**: BinGo v2.0
**Analysis Date**: {{ANALYSIS_DATE}}
**Analyst**: AI Agent

---

## Executive Summary

| Field | Value |
|-------|-------|
| **Target Binary** | `{{BINARY_NAME}}` |
| **File Hash (MD5)** | `{{MD5_HASH}}` |
| **Architecture** | {{ARCHITECTURE}} |
| **File Type** | {{FILE_TYPE}} |
| **Total Functions** | {{TOTAL_FUNCTIONS}} |
| **Vulnerabilities Found** | {{TOTAL_VULNS}} |
| **Critical** | {{CRITICAL_COUNT}} |
| **High** | {{HIGH_COUNT}} |
| **Medium** | {{MEDIUM_COUNT}} |
| **Low** | {{LOW_COUNT}} |

---

## Security Features Analysis

| Feature | Status | Exploit Impact |
|---------|--------|----------------|
| **NX (DEP)** | {{NX_STATUS}} | {{NX_IMPACT}} |
| **PIE** | {{PIE_STATUS}} | {{PIE_IMPACT}} |
| **Stack Canary** | {{CANARY_STATUS}} | {{CANARY_IMPACT}} |
| **RELRO** | {{RELRO_STATUS}} | {{RELRO_IMPACT}} |

---

## Vulnerability Details

{{VULN_DETAILS}}

---

## Vulnerability Details Template

For each vulnerability, use the following template:

### [{{VULN_ID}}] {{VULN_TYPE}} in `{{FUNCTION_NAME}}`

| Field | Value |
|-------|-------|
| **CWE** | {{CWE_ID}} |
| **Severity** | {{SEVERITY}} |
| **Confidence** | {{CONFIDENCE}} |
| **Location** | {{FUNCTION_NAME}}:{{ADDRESS}} (line {{LINE}}) |

#### Vulnerability Path

```
source: {{SOURCE_FUNCTION}} ({{SOURCE_LOCATION}})
  └─> {{INTERMEDIATE_FUNCTION_1}} ({{LOCATION_1}})
      └─> {{INTERMEDIATE_FUNCTION_2}} ({{LOCATION_2}})
          └─> {{SINK_FUNCTION}} ({{SINK_LOCATION}}) [SINK]
```

#### Complete Data Flow Path

**Step 1: Source Function**
```c
// File: {{SOURCE_FILE}}
// Function: {{SOURCE_FUNCTION}}
// Address: {{SOURCE_ADDRESS}}
// Lines: {{SOURCE_LINES}}
// ============================================================================
{{SOURCE_FULL_CODE}}
```

**Step 2: Intermediate Function{{#if HAS_INTERMEDIATE}}s{{/if}}**
```c
// File: {{INTERMEDIATE_FILE}}
// Function: {{INTERMEDIATE_FUNCTION}}
// Address: {{INTERMEDIATE_ADDRESS}}
// Lines: {{INTERMEDIATE_LINES}}
// ============================================================================
{{INTERMEDIATE_FULL_CODE}}
```

**Step 3: Sink Function (VULNERABLE)**
```c
// File: {{SINK_FILE}}
// Function: {{SINK_FUNCTION}}
// Address: {{SINK_ADDRESS}}
// Lines: {{SINK_LINES}}
// ============================================================================
{{SINK_FULL_CODE}}
```

#### Data Flow Diagram

```
{{DATA_FLOW_DIAGRAM}}
```

#### Buffer Size Analysis

{{#if BUFFER_ANALYSIS}}
| Buffer | Location | Size | Purpose |
|--------|----------|------|---------|
{{BUFFER_SIZE_TABLE}}

**Overflow Calculation:**
- Source size: {{SOURCE_SIZE}}
- Destination size: {{DEST_SIZE}}
- Safe limit: {{SAFE_LIMIT}}
- Actual copy: {{ACTUAL_COPY}}
- Overflow potential: {{OVERFLOW_AMOUNT}} bytes
{{/if}}

#### Missing Security Checks

| Protection | Status | Details |
|------------|--------|---------|
{{MISSING_PROTECTIONS_TABLE}}

#### Vulnerability Code (Annotated)

```c
// Location: {{FUNCTION_NAME}}:{{LINE}}
// ============================================================================
{{VULNERABLE_CODE_ANNOTATED}}
```

#### Analysis

{{ANALYSIS_TEXT}}

**Root Cause:**
{{ROOT_CAUSE}}

**Trigger Conditions:**
{{TRIGGER_CONDITIONS}}

**Impact if Exploited:**
{{EXPLOIT_IMPACT}}

#### Proof of Concept

```python
#!/usr/bin/env python3
"""
PoC for {{VULN_TYPE}} in {{FUNCTION_NAME}}
Target: {{BINARY_NAME}}
"""

import socket
import sys

# Configuration
TARGET_HOST = "{{TARGET_HOST}}"
TARGET_PORT = {{TARGET_PORT}}

def exploit():
    """Execute the exploit"""
    print(f"[*] Targeting {TARGET_HOST}:{TARGET_PORT}")

    # Build payload
    payload = build_payload()

    print(f"[*] Payload length: {len(payload)}")
    print(f"[*] Sending payload...")

    # Send payload
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sock.connect((TARGET_HOST, TARGET_PORT))
    sock.send(payload + b"\n")
    sock.close()

    print("[+] Payload sent")

def build_payload():
    """Build the exploit payload"""
    {{PAYLOAD_GENERATION_CODE}}

if __name__ == "__main__":
    exploit()
```

**Usage**:
```bash
python3 exploit.py
```

**Expected Result**: {{EXPECTED_RESULT}}

---

## Recommendations

1. {{RECOMMENDATION_1}}
2. {{RECOMMENDATION_2}}
3. {{RECOMMENDATION_3}}

---

## Appendix

### Analysis Configuration

| Parameter | Value |
|-----------|-------|
| **Decompiler** | {{DECOMPILER_VERSION}} |
| **Joern Version** | {{JOERN_VERSION}} |
| **Source Functions** | {{SOURCE_COUNT}} |
| **Sink Functions** | {{SINK_COUNT}} |
| **Flows Analyzed** | {{FLOWS_ANALYZED}} |
| **Analysis Duration** | {{DURATION}} |

### False Positives

The following potential issues were analyzed but determined to be false positives:

{{FALSE_POSITIVES}}

---

*Report generated by BinGo - Binary Vulnerability Analysis System*
